openapi: "3.0.2"
info:
  title: "NHSE-I-AAC API"
  version: "0.0.1"
servers:
  - url: https://nhse-${ENV}-innovation-service-functions.azurewebsites.net/api


paths:
  "/survey":
    post:
      tags:
        - "Survey"
        - "Create"
      description: "Creates a Survey object with answers"
      operationId: "survey-create-one"
      requestBody:
        $ref: "#/components/requestBodies/survey-create-payload"
      responses:
        "201":
          $ref: "#/components/responses/survey-create-201"
        "400":
          description: "Bad Request"
        "422":
          description: "UnprocessableEntity"

  "/accessors/{accessorId}/innovations":
    get:
      tags:
        - "Accessor"
        - "Innovation"
        - "GetInnovations"
      description: "Gets an Accessor's Innovations"
      operationId: "accessors-get-all-innovations"
      security:
        - OpenId:
            - accessors_details
      parameters:
        - name: accessorId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          $ref: "#/components/responses/accessor-get-innovations-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"

  "/innovators":
    get:
      tags:
        - "Innovator"
        - "List"
      description: "Retrieves the list of all innovators"
      operationId: "innovators-get-all"
      parameters:
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      security:
        - OpenId:
            - innovators_list
      responses:
        "200":
          $ref: "#/components/responses/innovator-get-all-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"

    post:
      tags:
        - "Innovator"
        - "Create"
      description: "Creates an Innovator"
      operationId: "innovators-create-one"
      parameters:
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      security:
        - OpenId:
            - innovators_create
      requestBody:
        $ref: "#/components/requestBodies/innovator-create-payload"
      responses:
        "201":
          $ref: "#/components/responses/innovator-create-201"
        "401":
          description: "Unauthorized"
        "400":
          description: "Bad Request"
        "422":
          description: "UnprocessableEntity"

  "/innovators/{innovatorId}":
    get:
      tags:
        - "Innovator"
        - "GetOne"
      description: "Retrieves an innovator"
      operationId: "innovators-get-one"
      security:
        - OpenId:
            - innovators_details
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          $ref: "#/components/responses/innovator-get-one-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
    head:
      tags:
        - "Innovator"
        - "HeadOne"
      description: "Retrieves an innovator"
      operationId: "innovators-head-one"
      security:
        - OpenId:
            - innovators_details
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          description: "Ok"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
    put:
      tags:
        - "Innovator"
        - "UpdateOne"
      description: "Updates an innovator"
      operationId: "innovators-update-one"
      security:
        - OpenId:
            - innovators_update
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      requestBody:
        $ref: "#/components/requestBodies/innovator-update-payload"
      responses:
        "200":
          $ref: "#/components/responses/innovator-update-200"
        "401":
          description: "Unauthorized"
        "400":
          description: "Bad Request"
        "422":
          description: "UnprocessableEntity"
    delete:
      tags:
        - "Innovator"
        - "DeleteOne"
      description: "Deletes/Inactivates an innovator"
      operationId: "innovators-delete-one"
      security:
        - OpenId:
            - innovators_delete
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          $ref: "#/components/responses/innovator-delete-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"

  "/innovators/{innovatorId}/innovations":
    get:
      tags:
        - "Innovator"
        - "Innovation"
        - "GetInnovations"
      description: "Gets an Innovator's Innovations"
      operationId: "innovators-get-all-innovations"
      security:
        - OpenId:
            - innovators_details
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          $ref: "#/components/responses/innovator-get-innovations-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
    post:
      tags:
        - "Innovator"
        - "Innovation"
        - "CreateInnovation"
      description: "Creates an Innovation associated with the Innovator"
      operationId: "innovators-create-innovation"
      security:
        - OpenId:
            - innovators_write
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      requestBody:
        $ref: "#/components/requestBodies/innovation-create-payload"
      responses:
        "201":
          $ref: "#/components/responses/innovator-create-innovation-201"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"

  "/innovators/{innovatorId}/innovations/{innovationId}":
    get:
      tags:
        - "Innovator"
        - "Innovation"
        - "GetInnovation"
      description: "Gets an Innovation associated with the Innovator"
      operationId: "innovators-get-innovation"
      security:
        - OpenId:
            - innovators_details
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          $ref: "#/components/responses/innovator-get-innovation-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
    put:
      tags:
        - "Innovator"
        - "Innovation"
        - "UpdateInnovation"
      description: "Updates an Innovation associated with the Innovator"
      operationId: "innovators-update-innovation"
      security:
        - OpenId:
            - innovators_write
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      requestBody:
        $ref: "#/components/requestBodies/innovation-update-payload"
      responses:
        "200":
          $ref: "#/components/responses/innovator-update-innovation-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
    delete:
      tags:
        - "Innovator"
        - "Innovation"
        - "DeleteInnovation"
      description: "Deletes an Innovation associated with the Innovator"
      operationId: "innovators-delete-innovation"
      security:
        - OpenId:
            - innovators_delete
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          $ref: "#/components/responses/innovator-delete-innovation-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"

  "/innovators/{innovatorId}/innovations/{innovationId}/section-summary":
    get:
      tags:
        - "Innovator"
        - "Innovation"
        - "GetInnovationSectionSummary"
      description: "Gets an Innovation Sections associated with the Innovator"
      operationId: "innovators-get-innovation-section-summary"
      security:
        - OpenId:
            - innovators_details
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          $ref: "#/components/responses/innovator-get-innovation-section-summary-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"

  "/innovators/{innovatorId}/innovations/{innovationId}/sections":
    get:
      tags:
        - "Innovator"
        - "Innovation"
        - "GetInnovationSection"
      description: "Get an Innovation Section associated with the Innovator"
      operationId: "innovators-get-innovation-sections"
      security:
        - OpenId:
            - innovators_details
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          $ref: "#/components/responses/innovator-get-innovation-section-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
        "403":
          description: "Forbidden"
    put:
      tags:
        - "Innovator"
        - "Innovation"
        - "UpdateInnovationSection"
      description: "Updates an Innovation Section associated with the Innovator"
      operationId: "innovators-update-innovation-sections"
      security:
        - OpenId:
            - innovators_write
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      requestBody:
        $ref: "#/components/requestBodies/innovation-update-section-payload"
      responses:
        "200":
          $ref: "#/components/responses/innovator-update-innovation-section-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
        "403":
          description: "Forbidden"

  "/innovators/{innovatorId}/innovations/{innovationId}/sections/submit":
    patch:
      tags:
        - "Innovator"
        - "Innovation"
        - "SubmitInnovationSection"
      description: "Submits an Innovation Section associated with the Innovator"
      operationId: "innovators-submit-innovation-sections"
      security:
        - OpenId:
            - innovators_write
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      requestBody:
        $ref: "#/components/requestBodies/innovation-submit-section-payload"
      responses:
        "204":
          description: "No Content"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
        "403":
          description: "Forbidden"

  "/innovators/{innovatorId}/innovations/{innovationId}/evidence":
    post:
      tags:
        - "Innovator"
        - "Innovation"
        - "CreateInnovationEvidence"
      description: "Creates an Innovation Evidence associated with the Innovation"
      operationId: "innovators-create-innovation-evidence"
      security:
        - OpenId:
            - innovators_write
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      requestBody:
        $ref: "#/components/requestBodies/innovation-create-evidence-payload"
      responses:
        "201":
          description: "Created"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
        "403":
          description: "Forbidden"

  "/innovators/{innovatorId}/innovations/{innovationId}/evidence/{evidenceId}":
    get:
      tags:
        - "Innovator"
        - "Innovation"
        - "GetInnovationEvidence"
      description: "Get an Innovation Evidence associated with the Innovation"
      operationId: "innovators-get-innovation-evidence"
      security:
        - OpenId:
            - innovators_details
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: evidenceId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          $ref: "#/components/responses/innovator-get-innovation-evidence-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
        "403":
          description: "Forbidden"
    put:
      tags:
        - "Innovator"
        - "Innovation"
        - "UpdateInnovationEvidence"
      description: "Updates an Innovation Evidence associated with the Innovation"
      operationId: "innovators-update-innovation-evidence"
      security:
        - OpenId:
            - innovators_write
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: evidenceId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      requestBody:
        $ref: "#/components/requestBodies/innovation-update-evidence-payload"
      responses:
        "200":
          description: "Ok"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
        "403":
          description: "Forbidden"
    delete:
      tags:
        - "Innovator"
        - "Innovation"
        - "DeleteInnovationEvidence"
      description: "Deletes an Innovation Evidence associated with the Innovation"
      operationId: "innovators-delete-innovation-evidence"
      security:
        - OpenId:
            - innovators_delete
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: evidenceId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          description: "Ok"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"

  "/innovators/{innovatorId}/innovations/{innovationId}/upload":
    post:
      tags:
        - "Innovator"
        - "Innovation"
        - "InnovatorsPostInnovationsFiles"
      description: "Creates an Innovation file metadata and returns a built upload url"
      operationId: "innovators-post-innovation-upload"
      security:
        - OpenId:
            - innovators_details
      parameters:
        - name: innovatorId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      requestBody:
        description: Innovation File Upload Payload
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                fileName:
                  type: string
                context:
                  type: string
      responses:
        "201":
          $ref: "#/components/responses/innovator-post-innovation-upload-201"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"

  "/me":
    get:
      tags:
        - "Users"
        - "GetProfile"
      description: "Retrieves the user profile"
      operationId: "users-get-profile"
      parameters:
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      security:
        - OpenId:
            - user_profile
      responses:
        "200":
          $ref: "#/components/responses/users-get-profile-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
  
  "/organisations":
    get:
      tags:
        - "Organisation"
        - "List"
      description: "Retrieves the list of all organisations with a filter"
      operationId: "organisations-get-all"
      parameters:
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      security:
        - OpenId:
            - organisations_list
      responses:
        "200":
          $ref: "#/components/responses/organisations-get-all-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
  
  "/assessments/{userId}/innovations/{innovationId}":
    get:
      tags:
        - "assessment"
        - "GetAssessmentsInnovationSummary"
      description: "Retrieves the Assessment Innovation Summary"
      operationId: "assessments-get-innovation"
      parameters:
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
        - name: userId
          in: path
          schema:
            type: string
          required: true
        - name: innovationId
          in: path
          schema:
            type: string
          required: true
      security:
        - OpenId:
            - user_profile
      responses:
        "200":
          $ref: "#/components/responses/assessments-get-innovation-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
  
  "/assessments/{userId}/innovations":
    get:
      tags:
        - "assessment"
        - "ListAssessmentsInnovations"
      description: "Retrieves the Assessment Innovation List"
      operationId: "assessments-list-innovations"
      parameters:
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
        - name: userId
          in: path
          schema:
            type: string
          required: true
      security:
        - OpenId:
            - user_profile
      responses:
        "200":
          $ref: "#/components/responses/assessments-list-innovations-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"

  "/assessments/{userId}/innovations/{innovationId}/assessments":
    post:
      tags:
        - "Assessment"
        - "Innovation"
        - "CreateInnovationAssessment"
      description: "Creates an Innovation Assessment associated with the Innovation"
      operationId: "assessments-create-innovation-assessment"
      security:
        - OpenId:
            - assessments_write
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      requestBody:
        $ref: "#/components/requestBodies/assessments-create-assessment-payload"
      responses:
        "201":
          description: "Created"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
        "403":
          description: "Forbidden"

  "/assessments/{userId}/innovations/{innovationId}/assessments/{assessmentId}":
    get:
      tags:
        - "Assessment"
        - "Innovation"
        - "GetInnovationAssessment"
      description: "Get an Innovation Assessment associated with the Innovation"
      operationId: "assessments-get-innovation-assessment"
      security:
        - OpenId:
            - innovators_details
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
        - name: innovationId
          in: path
          required: true
          schema:
            type: string
        - name: assessmentId
          in: path
          required: true
          schema:
            type: string
        - name: Authorization
          in: header
          schema:
            type: string
          required: true
      responses:
        "200":
          $ref: "#/components/responses/assessments-get-innovation-assessment-200"
        "404":
          description: "Not Found"
        "401":
          description: "Unauthorized"
        "403":
          description: "Forbidden"

components:
  schemas:
    accessor-schema:
      $ref: "./schemas/accessor-base-schema.yaml"
    accessor-get-innovations:
      $ref: "./schemas/accessor-get-innovations.yaml"
    innovator-schema:
      $ref: "./schemas/innovator-base-schema.yaml"
    innovation-schema:
      $ref: "./schemas/innovation-base-schema.yaml"
    organisation-schema:
      $ref: "./schemas/organisation-base-schema.yaml"
    survey-schema:
      $ref: "./schemas/survey-base-schema.yaml"
    innovator-get-all:
      $ref: "./schemas/innovator-get-all.yaml"
    organisations-get-all:
      $ref: "./schemas/organisations-get-all.yaml"
    innovator-get-one:
      $ref: "./schemas/innovator-get-one.yaml"
    innovator-get-innovations:
      $ref: "./schemas/innovator-get-innovations.yaml"
    innovator-get-innovation:
      $ref: "./schemas/innovator-get-innovation.yaml"
    innovator-post-innovation-upload:
      $ref: "./schemas/innovator-post-innovation-upload.yaml"
    profile-schema:
      $ref: "./schemas/users-profile-base-schema.yaml"
    assessments-innovation-schema:
      $ref: "./schemas/assessments-innovation-base-schema.yaml"
    assessments-innovations-schema:
      $ref: "./schemas/assessments-innovations-base-schema.yaml"
    survey-get-id:
      $ref: "./schemas/survey-get-id.yaml"

  requestBodies:
    innovator-create-payload:
      $ref: "./schemas/innovator-create-payload.yaml"
    innovator-update-payload:
      $ref: "./schemas/innovator-update-payload.yaml"
    innovation-create-payload:
      $ref: "./schemas/innovation-create-payload.yaml"
    innovation-update-payload:
      $ref: "./schemas/innovation-update-payload.yaml"
    innovation-update-section-payload:
      $ref: "./schemas/innovation-update-section-payload.yaml"
    innovation-update-evidence-payload:
      $ref: "./schemas/innovation-update-evidence-payload.yaml"
    innovation-create-evidence-payload:
      $ref: "./schemas/innovation-create-evidence-payload.yaml"
    innovation-submit-section-payload:
      $ref: "./schemas/innovation-submit-section-payload.yaml"
    survey-create-payload:
      $ref: "./schemas/survey-create-payload.yaml"
    assessments-create-assessment-payload:
      $ref: "./schemas/assessments-create-assessment-payload.yaml"

  responses:
    accessor-get-innovations-200:
      $ref: "./responses/accessor-get-innovations-200.yaml"
    innovator-get-all-200:
      $ref: "./responses/innovator-get-all-200.yaml"
    innovator-get-one-200:
      $ref: "./responses/innovator-get-one-200.yaml"
    innovator-create-201:
      $ref: "./responses/innovator-create-201.yaml"
    innovator-update-200:
      $ref: "./responses/innovator-update-200.yaml"
    innovator-delete-200:
      $ref: "./responses/innovator-delete-200.yaml"
    innovator-get-innovations-200:
      $ref: "./responses/innovator-get-innovations-200.yaml"
    innovator-get-innovation-section-summary-200:
      $ref: "./responses/innovator-get-innovation-section-summary-200.yaml"
    innovator-post-innovation-upload-201:
      $ref: "./responses/innovator-post-innovation-upload-201.yaml"
    innovator-get-innovation-200:
      $ref: "./responses/innovator-get-innovation-200.yaml"
    innovator-create-innovation-201:
      $ref: "./responses/innovator-create-innovation-201.yaml"
    innovator-update-innovation-200:
      $ref: "./responses/innovator-update-innovation-200.yaml"
    innovator-delete-innovation-200:
      $ref: "./responses/innovator-delete-innovation-200.yaml"
    innovator-get-innovation-section-200:
      $ref: "./responses/innovator-get-innovation-section-200.yaml"
    innovator-update-innovation-section-200:
      $ref: "./responses/innovator-update-innovation-section-200.yaml"
    innovator-get-innovation-evidence-200:
      $ref: "./responses/innovator-get-innovation-evidence-200.yaml"
    survey-create-201:
      $ref: "./responses/survey-create-201.yaml"
    users-get-profile-200:
      $ref: "./responses/users-get-profile-200.yaml"
    organisations-get-all-200:
      $ref: "./responses/organisations-get-all-200.yaml"
    assessments-get-innovation-200:
      $ref: "./responses/assessments-get-innovation-200.yaml"
    assessments-list-innovations-200:
      $ref: "./responses/assessments-get-innovation-200.yaml"
    assessments-get-innovation-assessment-200:
      $ref: "./responses/assessments-get-innovation-assessment-200.yaml"

  securitySchemes:
    OpenId:
      type: openIdConnect
      openIdConnectUrl: https://example.com/.well_known/openid-configuration
